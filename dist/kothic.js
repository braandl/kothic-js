/*
 (c) 2011-2019, Darafei Praliaskouski, Vladimir Agafonkin, Maksim Gurtovenko, Stephan Brandt
 Kothic JS is a full-featured JavaScript map rendering engine using HTML5 Canvas.
 Built on 23-08-2019 | https://github.com/kothic/kothic-js
*/

!function o(l,r,s){function f(t,e){if(!r[t]){if(!l[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=r[t]={exports:{}};l[t][0].call(n.exports,function(e){return f(l[t][1][e]||e)},n,n.exports,o,l,r,s)}return r[t].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)f(s[e]);return f}({1:[function(e,t,a){"use strict";e("./kothic.js"),e("./renderer/line.js"),e("./renderer/path.js"),e("./renderer/polygon.js"),e("./renderer/texticons.js"),e("./renderer/shields.js"),e("./renderer/text.js"),e("./style/mapcss.js"),e("./style/style.js"),e("./style/osmosnimki.js"),e("./utils/collisions.js"),e("./utils/geom.js"),e("./utils/rbush.js")},{"./kothic.js":2,"./renderer/line.js":3,"./renderer/path.js":4,"./renderer/polygon.js":5,"./renderer/shields.js":6,"./renderer/text.js":7,"./renderer/texticons.js":8,"./style/mapcss.js":9,"./style/osmosnimki.js":10,"./style/style.js":11,"./utils/collisions.js":12,"./utils/geom.js":13,"./utils/rbush.js":14}],2:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var p=i(e("./style/mapcss")),x=i(e("./utils/collisions")),w=i(e("./style/style")),y=i(e("./renderer/polygon")),m=i(e("./renderer/line")),u=i(e("./renderer/shields")),h=i(e("./renderer/texticons"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function g(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g)}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(g,null,[{key:"render",value:function(e,t,a,i){if(null!=t){"string"==typeof e&&(e=document.getElementById(e));var n=i&&i.styles||[];p.default.shared._locales=i&&i.locales||[];var o=Math.max(window.devicePixelRatio||1,2),l=e.width,r=e.height;1!==o&&(e.style.width=l+"px",e.style.height=r+"px",e.width=e.width*o,e.height=e.height*o);var s=e.getContext("2d");s.scale(o,o);var f=t.granularity,c=l/f,u=r/f,h=new x.default(r,l),d=w.default.populateLayers(t.features,a,n),y=g.getLayerIds(d);w.default.setStyles(s,w.default.defaultCanvasStyles),g.getFrame(function(){g._renderBackground(s,l,r,a,n),g._renderGeometryFeatures(y,d,s,c,u,f),i&&i.onRenderComplete&&i.onRenderComplete(),g.getFrame(function(){g._renderTextAndIcons(y,d,s,c,u,h)})})}}},{key:"_renderCollisions",value:function(e,t){var a,i,n;if(t.leaf)for(a=0,i=t.children.length;a<i;a++)e.strokeStyle="red",e.lineWidth=1,n=t.children[a],e.strokeRect(Math.round(n[0]),Math.round(n[1]),Math.round(n[2]-n[0]),Math.round(n[3]-n[1]));else for(a=0,i=t.children.length;a<i;a++)g._renderCollisions(e,t.children[a])}},{key:"getLayerIds",value:function(e){return Object.keys(e).sort(function(e,t){return parseInt(e,10)-parseInt(t,10)})}},{key:"getFrame",value:function(e){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame).call(window,e)}},{key:"_renderBackground",value:function(e,t,a,i,n){function o(){e.fillRect(-1,-1,t+1,a+1)}var l=p.default.shared.restyle(n,{},{},i,"canvas","canvas");for(var r in l)y.default.shared.fill(e,l[r],o)}},{key:"_renderGeometryFeatures",value:function(e,t,a,i,n,o){var l,r,s,f,c,u,h,d={};for(l=0;l<e.length;l++)for(f=t[e[l]],h=d._bg=d._bg||{},u=d[e[l]]=d[e[l]]||{},r=0,s=f.length;r<s;r++)("fill-color"in(c=f[r].style)||"fill-image"in c)&&("background"===c["fill-position"]?(h.polygons=h.polygons||[],h.polygons.push(f[r])):(u.polygons=u.polygons||[],u.polygons.push(f[r]))),"casing-width"in c&&(u.casings=u.casings||[],u.casings.push(f[r])),"width"in c&&(u.lines=u.lines||[],u.lines.push(f[r]));for(e=["_bg"].concat(e),l=0;l<e.length;l++)if(u=d[e[l]]){if(u.polygons)for(r=0,s=u.polygons.length;r<s;r++)y.default.shared.render(a,u.polygons[r],u.polygons[r+1],i,n,o);if(u.casings)for(a.lineCap="butt",r=0,s=u.casings.length;r<s;r++)m.default.shared.renderCasing(a,u.casings[r],u.casings[r+1],i,n,o);if(u.lines)for(a.lineCap="round",r=0,s=u.lines.length;r<s;r++)m.default.shared.render(a,u.lines[r],u.lines[r+1],i,n,o)}}},{key:"_renderTextAndIcons",value:function(e,t,a,i,n,o){var l,r,s;for(s=0;s<e.length;s++){var f=t[e[s]],c=f.length;for(l=c-1;0<=l;l--)(r=f[l].style).hasOwnProperty("icon-image")&&!r.text&&h.default.render(a,f[l],o,i,n,!1,!0);for(l=c-1;0<=l;l--)!(r=f[l].style).hasOwnProperty("icon-image")&&r.text&&h.default.render(a,f[l],o,i,n,!0,!1);for(l=c-1;0<=l;l--)(r=f[l].style).hasOwnProperty("icon-image")&&r.text&&h.default.render(a,f[l],o,i,n,!0,!0);for(l=c-1;0<=l;l--)(r=f[l].style)["shield-text"]&&u.default.render(a,f[l],o,i,n)}return[]}}]),g}();a.default=o},{"./renderer/line":3,"./renderer/polygon":5,"./renderer/shields":6,"./renderer/texticons":8,"./style/mapcss":9,"./style/style":11,"./utils/collisions":12}],3:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=i(e("./path")),d=i(e("../style/style")),y=i(e("../style/mapcss"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=null,l=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==o&&((o=this).pathOpened=!1),o}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(e,[{key:"renderCasing",value:function(e,t,a,i,n,o){var l=t.style,r=a&&a.style;this.pathOpened||(this.pathOpened=!0,e.beginPath()),new h.default(e,t,l["casing-dashes"]||l.dashes,!1,i,n,o),a&&r.width===l.width&&r["casing-width"]===l["casing-width"]&&r["casing-color"]===l["casing-color"]&&r["casing-dashes"]===l["casing-dashes"]&&r["casing-opacity"]===l["casing-opacity"]||(d.default.setStyles(e,{lineWidth:2*l["casing-width"]+(l.hasOwnProperty("width")?l.width:0),strokeStyle:l["casing-color"]||"#000000",lineCap:l["casing-linecap"]||l.linecap||"butt",lineJoin:l["casing-linejoin"]||l.linejoin||"round",globalAlpha:l["casing-opacity"]||1}),e.stroke(),this.pathOpened=!1)}},{key:"render",value:function(e,t,a,i,n,o){var l=t.style,r=a&&a.style;if(this.pathOpened||(this.pathOpened=!0,e.beginPath()),new h.default(e,t,l.dashes,!1,i,n,o),!a||r.width!==l.width||r.color!==l.color||r.image!==l.image||r.opacity!==l.opacity){if("color"in l||!("image"in l)){var s=l.width||1,f="round",c="round";s<=2&&(f="miter",c="butt"),d.default.setStyles(e,{lineWidth:s,strokeStyle:l.color||"#000000",lineCap:l.linecap||c,lineJoin:l.linejoin||f,globalAlpha:l.opacity||1,miterLimit:4}),e.stroke()}if("image"in l){var u=y.default.getImage(l.image);u&&(d.default.setStyles(e,{strokeStyle:e.createPattern(u,"repeat")||"#000000",lineWidth:l.width||1,lineCap:l.linecap||"round",lineJoin:l.linejoin||"round",globalAlpha:l.opacity||1}),e.stroke())}this.pathOpened=!1}}}],[{key:"shared",get:function(){return new e}}]),e}();a.default=l},{"../style/mapcss":9,"../style/style":11,"./path":4}],4:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,b=(i=e("../utils/geom"))&&i.__esModule?i:{default:i};function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function k(e,t,a,i,n,o,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k);var r=t.type,s=t.coordinates;"Polygon"===r?(s=[s],r="MultiPolygon"):"LineString"===r&&(s=[s],r="MultiLineString");var f,c,u,h,d,y,g,p,x,w,m,v,_=s.length;if("MultiPolygon"===r)for(f=0;f<_;f++)for(u=0,d=s[f].length;u<d;u++)for(y=(h=s[f][u]).length,g=h[0],c=0;c<=y;c++)p=h[c]||h[0],x=b.default.transformPoint(p,n,o),0===c?(e.moveTo(x[0],x[1]),a?e.setLineDash(a):e.setLineDash([])):!i&&k.checkSameBoundary(p,g,l)?e.moveTo(x[0],x[1]):e.lineTo(x[0],x[1]),g=p;else if("MultiLineString"===r){for(f=0;f<_;f++)for(y=(h=s[f]).length,c=0;c<y;c++){if(p=h[c],(0===c||c===y-1)&&k.isTileBoundary(p,l)){u=c;do{if((u=c?u-1:u+1)<0||y<=u)break;g=h[u],w=p[0]-g[0],m=p[1]-g[1],v=Math.sqrt(w*w+m*m)}while(v<=2);if(u<0||y<=u)break;p[0]=p[0]+50*w/v,p[1]=p[1]+50*m/v}x=b.default.transformPoint(p,n,o),0===c?(e.moveTo(x[0],x[1]),a?e.setLineDash(a):e.setLineDash([])):e.lineTo(x[0],x[1])}}}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(k,null,[{key:"isTileBoundary",value:function(e,t){var a=0;return 0===e[0]?a|=1:e[0]===t&&(a|=2),0===e[1]?a|=4:e[1]===t&&(a|=8),a}},{key:"checkSameBoundary",value:function(e,t,a){var i=k.isTileBoundary(e,a);return i?i&k.isTileBoundary(t,a):0}}]),k}();a.default=o},{"../utils/geom":13}],5:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=i(e("../style/mapcss")),l=i(e("../style/style")),s=i(e("./path"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=null,f=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==r&&(r=this),r}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(e,[{key:"render",value:function(e,t,a,i,n,o){var l=t.style,r=a&&a.style;this.pathOpened||(this.pathOpened=!0,e.beginPath()),new s.default(e,t,!1,!0,i,n,o),a&&r["fill-color"]===l["fill-color"]&&r["fill-image"]===l["fill-image"]&&r["fill-opacity"]===l["fill-opacity"]||(this.fill(e,l),this.pathOpened=!1)}},{key:"fill",value:function(e,t,a){var i,n=t["fill-opacity"]||t.opacity;t.hasOwnProperty("fill-color")&&(l.default.setStyles(e,{fillStyle:t["fill-color"]||"#000000",globalAlpha:n||1}),a?a():e.fill()),t.hasOwnProperty("fill-image")&&(i=o.default.getImage(t["fill-image"]))&&(l.default.setStyles(e,{fillStyle:e.createPattern(i,"repeat"),globalAlpha:n||1}),a?a():e.fill())}}],[{key:"shared",get:function(){return new e}}]),e}();a.default=f},{"../style/mapcss":9,"../style/style":11,"./path":4}],6:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var w=i(e("../utils/geom")),m=i(e("../style/mapcss")),v=i(e("../style/style"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(e,null,[{key:"render",value:function(e,t,a,i,n){var o,l,r,s,f=t.style,c=w.default.getReprPoint(t),u=0,h=!1;if(c&&(o=w.default.transformPoint(c,i,n),!f["shield-image"]||(l=m.default.getImage(f["icon-image"])))){v.default.setStyles(e,{font:v.default.getFontString(f["shield-font-family"]||f["font-family"],f["shield-font-size"]||f["font-size"],f),fillStyle:f["shield-text-color"]||"#000000",globalAlpha:f["shield-text-opacity"]||f.opacity||1,textAlign:"center",textBaseline:"middle"});var d=String(f["shield-text"]),y=e.measureText(d).width,g=y+2,p=1.8*(y/d.length);if("LineString"===t.type){if(u=w.default.getPolyLength(t.coordinates),Math.max(p/n,g/i)>u)return;for(r=0,s=1;r<u/2&&(c=w.default.getAngleAndCoordsAtLength(t.coordinates,u/2+s*r,0));r+=Math.max(u/30,p/i),s*=-1)if(c=[c[1],c[2]],o=w.default.transformPoint(c,i,n),!(l&&"true"!==f["allow-overlap"]&&a.checkPointWH(o,l.width,l.height,t.kothicId)||"true"!==f["allow-overlap"]&&a.checkPointWH(o,g,p,t.kothicId))){h=!0;break}}if(h){if(f["shield-casing-width"]){v.default.setStyles(e,{fillStyle:f["shield-casing-color"]||"#000000",globalAlpha:f["shield-casing-opacity"]||f.opacity||1});var x=f["shield-casing-width"]+(f["shield-frame-width"]||0);e.fillRect(o[0]-g/2-x,o[1]-p/2-x,g+2*x,p+2*x)}f["shield-frame-width"]&&(v.default.setStyles(e,{fillStyle:f["shield-frame-color"]||"#000000",globalAlpha:f["shield-frame-opacity"]||f.opacity||1}),e.fillRect(o[0]-g/2-(f["shield-frame-width"]||0),o[1]-p/2-(f["shield-frame-width"]||0),g+2*(f["shield-frame-width"]||0),p+2*(f["shield-frame-width"]||0))),f["shield-color"]&&(v.default.setStyles(e,{fillStyle:f["shield-color"]||"#000000",globalAlpha:f["shield-opacity"]||f.opacity||1}),e.fillRect(o[0]-g/2,o[1]-p/2,g,p)),l&&e.drawImage(l,Math.floor(o[0]-l.width/2),Math.floor(o[1]-l.height/2)),v.default.setStyles(e,{fillStyle:f["shield-text-color"]||"#000000",globalAlpha:f["shield-text-opacity"]||f.opacity||1}),e.fillText(d,o[0],Math.ceil(o[1])),l&&a.addPointWH(o,l.width,l.height,0,t.kothicId),a.addPointWH(o,p,g,(parseFloat(f["shield-casing-width"])||0)+(parseFloat(f["shield-frame-width"])||0)+(parseFloat(f["-x-mapnik-min-distance"])||30),t.kothicId)}}}}]),e}();a.default=o},{"../style/mapcss":9,"../style/style":11,"../utils/geom":13}],7:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,k=(i=e("../utils/geom"))&&i.__esModule?i:{default:i};function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function _(e,t,a,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_);var o=e.measureText(a).width,l=a.length,r=k.default.getPolyLength(t);if(!(r<o)){for(var s,f,c,u,h,d,y,g,p=_.getWidth(e,"a"),x=0,w=!1,m=Math.PI/6;x<2;){for(f=x?_.getWidth(e,a.charAt(0)):(r-o)/2,c=null,u=[],g=h=0;g<l;g++){if(s=a.charAt(g),y=_.getWidth(e,s),d=k.default.getAngleAndCoordsAtLength(t,f,y),r<=f||!d){x++,u=[],w&&(t.reverse(),w=!1);break}if(c=c||d[0],_.checkCollision(n,e,s,d,p)||Math.abs(c-d[0])>m)f+=y,g=-1,u=[],h=0;else{for(;y<d[3]&&g<l;){if(g++,s+=a.charAt(g),y=_.getWidth(e,s),_.checkCollision(n,e,s,d,p)){f+=y,u=[],h=g=0,s=a.charAt(g),y=_.getWidth(e,s),d=k.default.getAngleAndCoordsAtLength(t,f,y);break}if(y>=d[3]){g--,s=s.slice(0,-1),y=_.getWidth(e,s);break}}d&&((d[0]>Math.PI/2||d[0]<-Math.PI/2)&&(h+=s.length),c=d[0],d.push(s),u.push(d),f+=y)}}if(l/2<h&&(t.reverse(),u=[],w=!w||(x++,t.reverse(),!1)),2<=x)return;if(0<u.length)break}var v=u.length;for(g=0;i&&g<v;g++)_.renderText(e,u[g],!0);for(g=0;g<v;g++)d=u[g],_.renderText(e,d),_.addCollision(n,e,d[4],d,p)}}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(_,null,[{key:"getWidth",value:function(e,t){return e.measureText(t).width}},{key:"getTextCenter",value:function(e,t){return[e[1]+.5*Math.cos(e[0])*t,e[2]+.5*Math.sin(e[0])*t]}},{key:"getCollisionParams",value:function(e,t,a){var i=1.5*e,n=Math.abs(Math.cos(t[0])),o=Math.abs(Math.sin(t[0])),l=n*e+o*i,r=o*e+n*i;return[_.getTextCenter(t,e+2*(a||0)),l,r,0]}},{key:"checkCollision",value:function(e,t,a,i,n){for(var o=_.getWidth(t,a),l=0;l<o;l+=n)if(e.checkPointWH.apply(e,_.getCollisionParams(n,i,l)))return!0;return!1}},{key:"addCollision",value:function(e,t,a,i,n){for(var o=_.getWidth(t,a),l=[],r=0;r<o;r+=n)l.push(_.getCollisionParams(n,i,r));e.addPoints(l)}},{key:"renderText",value:function(e,t,a){var i=t[4],n=_.getTextCenter(t,_.getWidth(e,i));e.translate(n[0],n[1]),e.rotate(t[0]),e[a?"strokeText":"fillText"](i,0,0),e.rotate(-t[0]),e.translate(-n[0],-n[1])}}]),_}();a.default=o},{"../utils/geom":13}],8:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var k=i(e("../style/style")),b=i(e("../utils/geom")),z=i(e("../style/mapcss")),M=i(e("./text"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(e,null,[{key:"render",value:function(e,t,a,i,n,o,l){var r,s,f,c,u=t.style;if(l||o&&"LineString"!==t.type){var h=b.default.getReprPoint(t);if(!h)return;s=b.default.transformPoint(h,i,n)}if(l){if(!(r=z.default.getImage(u["icon-image"])))return;if(f=r.width,c=r.height,(u["icon-width"]||u["icon-height"])&&(u["icon-width"]&&(f=u["icon-width"],c=r.height*f/r.width),u["icon-height"]&&(c=u["icon-height"],u["icon-width"]||(f=r.width*c/r.height))),"true"!==u["allow-overlap"]&&a.checkPointWH(s,f,c,t.kothicId))return}var d=String(u.text).trim();if(o&&d){k.default.setStyles(e,{lineWidth:2*u["text-halo-radius"],font:k.default.getFontString(u["font-family"],u["font-size"],u)});var y=u.hasOwnProperty("text-halo-radius");if(k.default.setStyles(e,{fillStyle:u["text-color"]||"#000000",strokeStyle:u["text-halo-color"]||"#ffffff",globalAlpha:u["text-opacity"]||u.opacity||1,textAlign:"center",textBaseline:"middle"}),"uppercase"===u["text-transform"]?d=d.toUpperCase():"lowercase"===u["text-transform"]?d=d.toLowerCase():"capitalize"===u["text-transform"]&&(d=d.replace(/(^|\s)\S/g,function(e){return e.toUpperCase()})),"Polygon"===t.type||"Point"===t.type){var g=e.measureText(d).width,p=g,x=2.5*(g/d.length),w=u["text-offset"]||0;if("true"!==u["text-allow-overlap"]&&a.checkPointWH([s[0],s[1]+w],p,x,t.kothicId))return;y&&e.strokeText(d,s[0],s[1]+w),e.fillText(d,s[0],s[1]+w);var m=u["-x-kot-min-distance"]||20;a.addPointWH([s[0],s[1]+w],p,x,m,t.kothicId)}else if("LineString"===t.type){var v=b.default.transformPoints(t.coordinates,i,n);new M.default(e,v,d,y,a)}}if(l){e.drawImage(r,Math.floor(s[0]-f/2),Math.floor(s[1]-c/2),f,c);var _=parseFloat(u["-x-kot-min-distance"])||0;a.addPointWH(s,f,c,_,t.kothicId)}}}]),e}();a.default=o},{"../style/mapcss":9,"../style/style":11,"../utils/geom":13,"./text":7}],9:[function(e,t,a){"use strict";function i(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=null,o=function(){function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),null==n&&((n=this)._styles={},this._availableStyles=[],this._images={},this._locales=[],this._presence_tags=[],this._value_tags=[],this._cache={},this._debug={hit:0,miss:0}),n}return function(e,t,a){t&&i(e.prototype,t),a&&i(e,a)}(s,[{key:"getTagKeys",value:function(e,t,a,i){var n,o=[];for(n=0;n<this._presence_tags.length;n++)e.hasOwnProperty(this._presence_tags[n])&&o.push(this._presence_tags[n]);for(n=0;n<this._value_tags.length;n++)e.hasOwnProperty(this._value_tags[n])&&o.push(this._value_tags[n]+":"+e[this._value_tags[n]]);return[t,a,i,o.join(":")].join(":")}},{key:"restyle",value:function(e,t,a,i,n){var o,l=this.getTagKeys(t,a,i,n),r=this._cache[l]||{};if(this._cache.hasOwnProperty(l))this._debug.hit+=1;else{for(this._debug.miss+=1,o=0;o<e.length;o++)r=s.shared._styles[e[o]].restyle(r,t,a,i,n);this._cache[l]=r}return r}},{key:"availableStyles",get:function(){return this._availableStyles}}],[{key:"onError",value:function(){}},{key:"onImagesLoad",value:function(){}},{key:"invalidateCache",value:function(){this._cache={}}},{key:"e_min",value:function(){return Math.min.apply(null,arguments)}},{key:"e_max",value:function(){return Math.max.apply(null,arguments)}},{key:"e_any",value:function(){var e;for(e=0;e<arguments.length;e++)if(void 0!==arguments[e]&&""!==arguments[e])return arguments[e];return""}},{key:"e_num",value:function(e){return isNaN(parseFloat(e))?"":parseFloat(e)}},{key:"e_str",value:function(e){return e}},{key:"e_int",value:function(e){return parseInt(e,10)}},{key:"e_tag",value:function(e,t){return e.hasOwnProperty(t)&&null!==e[t]?t:""}},{key:"e_prop",value:function(e,t){return e.hasOwnProperty(t)&&null!==e[t]?e[t]:""}},{key:"e_sqrt",value:function(e){return Math.sqrt(e)}},{key:"e_boolean",value:function(e,t,a){return void 0===t&&(t="true"),void 0===a&&(a="false"),"0"===e||"false"===e||""===e?a:t}},{key:"e_metric",value:function(e){return/\d\s*mm$/.test(e)?1e3*parseInt(e,10):/\d\s*cm$/.test(e)?100*parseInt(e,10):/\d\s*dm$/.test(e)?10*parseInt(e,10):/\d\s*km$/.test(e)?.001*parseInt(e,10):/\d\s*in$/.test(e)?.0254*parseInt(e,10):/\d\s*ft$/.test(e)?.3048*parseInt(e,10):parseInt(e,10)}},{key:"e_zmetric",value:function(e){return s.shared.e_metric(e)}},{key:"e_localize",value:function(e,t){var a,i,n=s.shared._locales;for(a=0;a<n.length;a++)if(e[i=t+":"+n[a]])return e[i];return e[t]}},{key:"loadStyle",value:function(e,t,a,i,n,o){var l;if(a=a||[],i=i||[],n)for(l=0;l<n.length;l++)s.shared._presence_tags.indexOf(n[l])<0&&s.shared._presence_tags.push(n[l]);if(o)for(l=0;l<o.length;l++)s.shared._value_tags.indexOf(o[l])<0&&s.shared._value_tags.push(o[l]);s.shared._styles[e]={restyle:t,images:a,external_images:i,textures:{},sprite_loaded:!a,external_images_loaded:!i.length},s.shared._availableStyles.push(e)}},{key:"_onImagesLoad",value:function(e){s.shared._styles[e].external_images_loaded&&s.shared._styles[e].sprite_loaded&&s.onImagesLoad()}},{key:"preloadSpriteImage",value:function(t,e){var a=s.shared._styles[t]._images,i=new Image;delete s.shared._styles[t]._images,i.onload=function(){var e;for(e in a)a.hasOwnProperty(e)&&(a[e].sprite=i,s.shared._images[e]=a[e]);s.shared._styles[t].sprite_loaded=!0,s._onImagesLoad(t)},i.onerror=function(e){s.onError(e)},i.src=e}},{key:"preloadExternalImages",value:function(a,e){var t=s.shared._styles[a].external_images;delete s.shared._styles[a].external_images,e=e||"";var i,n=t.length,o=0;function l(e){var t=new Image;t.onload=function(){o++,s.shared._images[e]={sprite:t,height:t.height,width:t.width,offset:0},o===n&&(s.shared._styles[a].external_images_loaded=!0,s._onImagesLoad(a))},t.onerror=function(){++o===n&&(s.shared._styles[a].external_images_loaded=!0,s._onImagesLoad(a))},t.src=e}for(i=0;i<n;i++)l(e+t[i])}},{key:"getImage",value:function(e){var t=s.shared._images[e];if(t&&t.sprite){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t.sprite,0,t.offset,t.width,t.height,0,0,t.width,t.height),t=s.shared._images[e]=a}return t}},{key:"shared",get:function(){return new s}}]),s}();a.default=o},{}],10:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,f=(i=e("./mapcss"))&&i.__esModule?i:{default:i};function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sprite_images={},this.external_images=[],this.presence_tags=["shop"],this.value_tags=["color","amenity","pk","building ","wall","surface","marking","service","addr:housenumber","population","leisure","waterway","aeroway","landuse","barrier","colour","railway","oneway","religion","tourism","admin_level","transport","name","building","place","residential","highway","ele","living_street","natural","boundary","capital"],f.default.loadStyle("styles/contagt",this.restyle,this.sprite_images,this.external_images,this.presence_tags,this.value_tags),f.default.preloadExternalImages("styles/contagt")}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(e,[{key:"restyle",value:function(e,t,a,i,n){var o={},l={},r={},s={};return"background"===t.surface&&(o["fill-color"]="#FFFFFF",o["fill-opacity"]=1,o["z-index"]=1),"floor"===t.surface&&(o["fill-color"]="#F5F4FF",o["fill-opacity"]=1,o["z-index"]=31),"steps"===t.surface&&"area"===n&&(o["fill-color"]="#FFA384",o.opacity=1,o["z-index"]=33),"elevator"===t.surface&&(o["fill-color"]="#CCA384",o.opacity=1,o["z-index"]=33),"elevator"===t.surface&&"area"===n&&(o["fill-color"]="#CCA384",o.opacity=1,o["z-index"]=33),"steps"===t.highway&&(o["fill-color"]="#FFA384",o["fill-opacity"]=1,o["z-index"]=33),"elevator"===t.highway&&(o["fill-color"]="#CCA384",o["fill-opacity"]=1,o["z-index"]=33),"balcony"===t.surface&&"area"===n&&(o["fill-color"]="#875646",o["fill-opacity"]=.6,o["z-index"]=33),"door"===t.surface&&"line"==n&&(o.color="#DBDBDB",o.width=1,o["z-index"]=39),"solid"===t.surface&&"area"===n&&(o["fill-color"]="#0B0811",o["fill-opacity"]=.9,o["z-index"]=30),"transparent"===t.surface&&"area"===n&&(o["fill-color"]="#FFF",o["fill-opacity"]=.4,o["z-index"]=30),"plant"===t.surface&&"area"===n&&(o["fill-color"]="#83DF60",o["fill-opacity"]=.9,o["z-index"]=30),"sand"===t.surface&&"area"===n&&(o["fill-color"]="#FDD485",o.color="#000000",o.opacity=.8,o["fill-opacity"]=.9,o.width=1.5,o["z-index"]=30,o.dashes=[9,9]),"concrete"===t.surface&&"area"===n&&(o["fill-color"]="#DDDDDD",o["fill-opacity"]=.9,o["z-index"]=30,o.color="#222222",o.width=1.5,o.opacity=.6,o.dashes=[9,3]),"paving_slab"===t.surface&&"area"===n&&(o["fill-color"]="#E0D0DB",o.color="#222222",o["fill-opacity"]=.6,o.width=1.5,o["z-index"]=30,o.dashes=[5,2]),"door"===t.surface&&"area"===n&&(o["fill-color"]="#607F84",o["fill-opacity"]=.6,o.color="#000000",o.width=1.5,o["z-index"]=39),"green"===t.surface&&"area"===n&&(o["fill-color"]="#88C037",o["fill-opacity"]=.2,o["z-index"]=30),"window"===t.surface&&"area"===n&&(o["fill-color"]="#13C5CF",o["fill-opacity"]=.3,o.color="#000000",o.width=1.5,o["z-index"]=35),"sanitary"==t.surface&&"area"==n&&(o["fill-color"]="#EECFFC",o["fill-opacity"]=1,o["z-index"]=36),"beverages"==t.surface&&"area"==n&&(o["fill-color"]="#E3EFEA",o["fill-opacity"]=1,o["z-index"]=36),"room"==t.surface&&"area"==n&&(o["fill-color"]="#E9E9E9",o["fill-opacity"]=1,o["z-index"]=36),"yes"===t.handrail&&(o.color="#111111",o.width=1.5,o["z-index"]=27,o.dashes=[5,5]),"way"===i&&"yes"===t.wall&&a<12&&(o.color="#000000",o.width=.5,o["z-index"]=27),"yes"===t.wall&&a<16&&12<=a&&(o.color="#000000",o.width=1,o["z-index"]=27),"yes"===t.wall&&16<=a&&(o.color="#000000",o.width=1.5,o["z-index"]=27),16<=t.wall&&(o.color="#000000",o.width=1.5,o["z-index"]=27),"yes"==t.wall&&"area"==n&&(o["fill-color"]="#E9E9E9",o["fill-opacity"]=2,o["z-index"]=22),"yes"===t.building&&"area"==n&&(o["fill-color"]="#DDDAD3",o["fill-opacity"]=1,o.color="#CCC9C4",o.width=1.5,o["z-index"]=8),"area"===n&&"coastline"===t.natural&&(o["fill-color"]="#fcf8e4",o["-x-mapnik-layer"]="bottom"),"area"===n&&"glacier"===t.natural&&(o["fill-color"]="#fcfeff"),"area"===n&&"park"===t.leisure&&(o["fill-color"]="#c4e9a4",o["z-index"]=3),("area"===n&&"garden"===t.leisure||"area"===n&&"orchard"===t.landuse)&&(o["z-index"]=3),"area"===n&&"scrub"===t.natural&&(o["fill-color"]="#e5f5dc",o["z-index"]=3),"area"===n&&"heath"===t.natural&&(o["fill-color"]="#ecffe5",o["z-index"]=3),("area"===n&&"industrial"===t.landuse||"area"===n&&"military"===t.landuse)&&(o["fill-color"]="#ddd8da",o["z-index"]=3),"area"===n&&"parking"===t.amenity&&(o["fill-color"]="#ecedf4",o["z-index"]=3),("area"===n&&"forest"===t.natural||"area"===n&&"wood"===t.natural||"area"===n&&"forest"===t.landuse||"area"===n&&"wood"===t.landuse)&&(o["fill-color"]="#d6f4c6",o["z-index"]=3),"area"===n&&"garages"===t.landuse&&10<=a&&(o["fill-color"]="#ddd8da",o["z-index"]=3),("area"===n&&"forest"===t.natural||"area"===n&&"wood"===t.natural&&10<=a||"area"===n&&"forest"===t.landuse||"area"===n&&"wood"===t.landuse)&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=0,o["font-size"]="10",o["font-family"]="DejaVu Serif Italic",o["text-color"]="green",o["text-allow-overlap"]="false",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["-x-mapnik-min-distance"]="0 "),("area"===n&&"grass"===t.landuse||"area"===n&&"grass"===t.natural||"area"===n&&"meadow"===t.natural||"area"===n&&"meadow"===t.landuse||"area"===n&&"recreation_ground"===t.landuse)&&(o["fill-color"]="#f4ffe5",o["z-index"]=4),"area"===n&&"wetland"===t.natural&&(o["z-index"]=4),("area"===n&&"farmland"===t.landuse||"area"===n&&"farm"===t.landuse||"area"===n&&"field"===t.landuse)&&(o["fill-color"]="#fff5c4",o["z-index"]=5),"area"===n&&"cemetery"===t.landuse&&(o["fill-color"]="#e5f5dc",o["z-index"]=5),"area"===n&&"aerodrome"===t.aeroway&&(o.color="#008ac6",o.width=.8,o["z-index"]=5),("area"===n&&"stadium"===t.leisure||"area"===n&&"pitch"===t.leisure)&&(o["fill-color"]="#e3deb1",o["z-index"]=5),"way"===i&&"river"===t.waterway&&(o.color="#C4D4F5",o.width=.9,o["z-index"]=9),"way"===i&&"stream"===t.waterway&&(o.color="#C4D4F5",o.width=.5,o["z-index"]=9),"way"===i&&"canal"===t.waterway&&(o.color="#abc4f5",o.width=.6,o["z-index"]=9),("area"===n&&"riverbank"===t.waterway||"area"===n&&"water"===t.natural||"area"===n&&"reservoir"===t.landuse)&&(o["fill-color"]="#C4D4F5",o.color="#C4D4F5",o.width=.1,o["z-index"]=9),"area"===n&&"water"===t.natural&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=1,o["font-size"]="10",o["font-family"]="DejaVu Serif Italic",o["text-color"]="#285fd1",o["text-allow-overlap"]="false",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff"),"way"===i&&"construction"===t.highway&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o.width=2,o.color="#ffffff",o["z-index"]=10,o.dashes=[9,9]),"way"===i&&"construction"===t.highway&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o.width=3,o.color="#ffffff",o["z-index"]=10,o.dashes=[9,9]),("way"===i&&"footway"===t.highway||"way"===i&&"path"===t.highway||"way"===i&&"cycleway"===t.highway||"way"===i&&"pedestrian"===t.highway)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["casing-width"]=.3,o["casing-color"]="#bf96ce",o.width=.2,o.color="#ffffff",o["z-index"]=10,o.dashes=[2,2]),"way"===i&&"steps"===t.highway&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["casing-width"]=.3,o["casing-color"]="#ffffff",o.width=3,o.color="#bf96ce",o["z-index"]=10,o.dashes=[1,1],o.linecap="butt"),("way"===i&&"road"===t.highway||"way"===i&&"track"===t.highway)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=1.5,o.color="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=9),("way"===i&&"road"===t.highway||"way"===i&&"track"===t.highway)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=2.5,o.color="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=9),"way"===i&&"service"===t.highway&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=1.2,o.color="#ffffff",o["casing-width"]=.3,o["casing-color"]="#996703",o["z-index"]=10),("way"===i&&"residential"===t.highway&&16===a||"way"===i&&"unclassified"===t.highway&&16===a||"way"===i&&"living_street"===t.highway&&16===a||"way"===i&&"service"===t.highway&&("-1"===t.living_street||"false"===t.living_street||"no"===t.living_street)&&"parking_aisle"!==t.service&&16===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=3.5,o.color="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=10),("way"===i&&"residential"===t.highway||"way"===i&&"unclassified"===t.highway||"way"===i&&"living_street"===t.highway||"way"===i&&"service"===t.highway&&("-1"===t.living_street||"false"===t.living_street||"no"===t.living_street)&&"parking_aisle"!==t.service)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Book",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=4.5,o.color="#ffffff",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=10),("way"===i&&"secondary"===t.highway&&16===a||"way"===i&&"secondary_link"===t.highway&&16===a||"way"===i&&"tertiary"===t.highway&&16===a||"way"===i&&"tertiary_link"===t.highway&&16===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=7,o.color="#fcffd1",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=11),("way"===i&&"secondary"===t.highway&&17===a||"way"===i&&"secondary_link"===t.highway&&17===a||"way"===i&&"tertiary"===t.highway&&17===a||"way"===i&&"tertiary_link"===t.highway&&17===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=8,o.color="#fcffd1",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=11),("way"===i&&"secondary"===t.highway&&18===a||"way"===i&&"secondary_link"===t.highway&&18===a||"way"===i&&"tertiary"===t.highway&&18===a||"way"===i&&"tertiary_link"===t.highway&&18===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=9,o.color="#fcffd1",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=11),("way"===i&&"primary"===t.highway&&16===a||"way"===i&&"primary_link"===t.highway&&16===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=9,o.color="#fcea97",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=12),("way"===i&&"primary"===t.highway&&17===a||"way"===i&&"primary_link"===t.highway&&17===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=10,o.color="#fcea97",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=12),("way"===i&&"primary"===t.highway&&18===a||"way"===i&&"primary_link"===t.highway&&18===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=11,o.color="#fcea97",o["casing-width"]=.5,o["casing-color"]="#996703",o["z-index"]=12),("way"===i&&"trunk"===t.highway&&17===a||"way"===i&&"trunk_link"===t.highway&&17===a||"way"===i&&"motorway"===t.highway&&17===a||"way"===i&&"motorway_link"===t.highway&&17===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=12,o.color="#ffd780",o["casing-width"]=1,o["casing-color"]="#996703",o["z-index"]=13),("way"===i&&"trunk"===t.highway&&18===a||"way"===i&&"trunk_link"===t.highway&&18===a||"way"===i&&"motorway"===t.highway&&18===a||"way"===i&&"motorway_link"===t.highway&&18===a)&&(o.text=f.default.e_localize(t,"name"),o["text-position"]="line",o["text-color"]="#404040",o["font-family"]="DejaVu Sans Bold",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o.width=13,o.color="#ffd780",o["casing-width"]=1,o["casing-color"]="#996703",o["z-index"]=13),("way"===i&&"trunk"===t.highway||"way"===i&&"trunk_link"===t.highway||"way"===i&&"motorway"===t.highway||"way"===i&&"motorway_link"===t.highway||"way"===i&&"primary"===t.highway||"way"===i&&"primary_link"===t.highway)&&(l.width=.3,l.color="#fa6478",l["z-index"]=14,l["-x-mapnik-layer"]="top"),"way"!==i||"1"!==t.oneway&&"true"!==t.oneway&&"yes"!==t.oneway||(o["line-style"]="arrows",o["z-index"]=15,o["-x-mapnik-layer"]="top"),"line"===n&&"rail"===t.railway&&(o.width=1.4,o.color="#606060",o["z-index"]=15),"line"===n&&"rail"===t.railway&&(r.width=1,r.color="#ffffff",r.dashes=[6,6],r["z-index"]=16),"way"===i&&"subway"===t.railway&&(o.width=3,o.color="#072889",o["z-index"]=15,o.dashes=[3,3],o.opacity=.3,o.linecap="butt",o["-x-mapnik-layer"]="top"),"way"===i&&"fence"===t.barrier&&(o.width=.3,o.color="black",o["z-index"]=16,o["-x-mapnik-layer"]="top"),"way"===i&&"wall"===t.barrier&&(o.width=.5,o.color="black",o["z-index"]=16,o["-x-mapnik-layer"]="top"),"way"!==i||"sport"!==t.marking||t.hasOwnProperty("colour")||t.hasOwnProperty("color")||(o.width=.5,o.color="#a0a0a0",o["z-index"]=16,o["-x-mapnik-layer"]="top"),("way"===i&&"sport"===t.marking&&"white"===t.colour||"way"===i&&"sport"===t.marking&&"white"===t.color)&&(o.width=1,o.color="white",o["z-index"]=16,o["-x-mapnik-layer"]="top"),("way"===i&&"sport"===t.marking&&"red"===t.colour||"way"===i&&"sport"===t.marking&&"red"===t.color)&&(o.width=1,o.color="#c00000",o["z-index"]=16,o["-x-mapnik-layer"]="top"),("way"===i&&"sport"===t.marking&&"black"===t.colour||"way"===i&&"sport"===t.marking&&"black"===t.color)&&(o.width=1,o.color="black",o["z-index"]=16,o["-x-mapnik-layer"]="top"),"node"===i&&"place_of_worship"===t.amenity&&(o.text=f.default.e_localize(t,"name"),o["text-color"]="#623f00",o["font-family"]="DejaVu Serif Italic",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-offset"]=3,o["max-width"]=70),"area"===n&&"place_of_worship"===t.amenity&&(o.text=f.default.e_localize(t,"name"),o["text-color"]="#623f00",o["font-family"]="DejaVu Serif Italic",o["font-size"]="9",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-offset"]=3,o["max-width"]=70,o["z-index"]=16,o.width=.1,o.color="#111111",o["text-opacity"]="1",o["fill-color"]="#777777",o["fill-opacity"]=.5),"area"===n&&"administrative"===t.boundary&&"2"===t.admin_level&&(o.width=.5,o.color="#202020",o.dashes=[6,4],o.opacity=.7,o["z-index"]=16),"area"===n&&"administrative"===t.boundary&&"3"===t.admin_level&&(o.width=1.3,o.color="#ff99cc",o.opacity=.5,o["z-index"]=16),"area"===n&&"administrative"===t.boundary&&"6"===t.admin_level&&(o.width=.5,o.color="#101010",o.dashes=[1,2],o.opacity=.6,o["z-index"]=16.1),"area"===n&&"administrative"===t.boundary&&"4"===t.admin_level&&(o.width=.7,o.color="#000000",o.dashes=[1,2],o.opacity=.8,o["z-index"]=16.3),"way"===i&&"tram"===t.railway&&(o["z-index"]=17),"node"===i&&"station"===t.railway&&"subway"!==t.transport&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=7,o["font-size"]="9",o["font-family"]="DejaVu Sans Mono Book",o["text-halo-radius"]=1,o["text-color"]="#000d6c",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false",o["-x-mapnik-min-distance"]="0"),"node"===i&&"subway_entrance"===t.railway&&(o["z-index"]=17),"node"===i&&"subway_entrance"===t.railway&&t.hasOwnProperty("name")&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=11,o["font-size"]="9",o["font-family"]="DejaVu Sans Book",o["text-halo-radius"]=2,o["text-color"]="#1300bb",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false",o["-x-mapnik-min-distance"]="0"),"node"===i&&"aerodrome"===t.aeroway&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=12,o["font-size"]="9",o["font-family"]="DejaVu Sans Condensed Bold",o["text-halo-radius"]=1,o["text-color"]="#1e7ca5",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false",o["z-index"]=17),"node"===i&&"town"===t.place&&(o.text=f.default.e_localize(t,"name"),o["font-size"]="80",o["font-family"]="DejaVu Sans Book",o["text-color"]="#101010",o["text-opacity"]="0.2",o["text-allow-overlap"]="true",o["z-index"]=20),"node"===i&&"city"===t.place&&(o.text=f.default.e_localize(t,"name"),o["font-size"]="100",o["font-family"]="DejaVu Sans Book",o["text-color"]="#101010",o["text-opacity"]="0.3",o["text-allow-overlap"]="true",o["z-index"]=20),"node"===i&&"village"===t.place&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=1,o["font-size"]="9",o["font-family"]="DejaVu Sans Book",o["text-halo-radius"]=1,o["text-color"]="#606060",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false"),"node"===i&&"hamlet"===t.place&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=1,o["font-size"]="8",o["font-family"]="DejaVu Sans Book",o["text-halo-radius"]=1,o["text-color"]="#505050",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false"),("area"===n&&"nature_reserve"===t.landuse||"area"===n&&"park"===t.leisure)&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=1,o["font-size"]="10",o["font-family"]="DejaVu Serif Italic",o["text-halo-radius"]=0,o["text-color"]="#3c8000",o["text-halo-color"]="#ffffff",o["text-allow-overlap"]="false"),("way"===i&&"stream"===t.waterway||"way"===i&&"river"===t.waterway||"way"===i&&"canal"===t.waterway)&&(o.text=f.default.e_localize(t,"name"),o["font-size"]="9",o["font-family"]="DejaVu Sans Oblique",o["text-color"]="#547bd1",o["text-halo-radius"]=1,o["text-halo-color"]="#ffffff",o["text-position"]="line"),"node"===i&&"ocean"===t.place&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=0,o["font-size"]="11",o["font-family"]="DejaVu Sans Oblique",o["text-halo-radius"]=1,o["text-color"]="#202020",o["text-halo-color"]="#ffffff",o["z-index"]=-1,o["-x-mapnik-min-distance"]="0"),"node"===i&&"sea"===t.place&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=0,o["font-size"]="10",o["font-family"]="DejaVu Sans Oblique",o["text-halo-radius"]=1,o["text-color"]="#4976d1",o["text-halo-color"]="#ffffff",o["-x-mapnik-min-distance"]="0"),"node"===i&&"peak"===t.natural&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=3,o["font-size"]="7",o["font-family"]="DejaVu Sans Mono Book",o["text-halo-radius"]=0,o["text-color"]="#664229",o["text-halo-color"]="#ffffff",o["-x-mapnik-min-distance"]="0"),"area"===n&&"administrative"===t.boundary&&"6"===t.admin_level&&(o.text=f.default.e_localize(t,"name"),o["text-offset"]=-10,o["font-size"]="12",o["font-family"]="DejaVu Sans ExtraLight",o["text-halo-radius"]=1,o["text-color"]="#7848a0",o["text-halo-color"]="#ffffff"),"node"===i&&"suburb"===t.place&&(o.text=f.default.e_localize(t,"name"),o["font-size"]="12",o["font-family"]="DejaVu Sans ExtraLight",o["text-color"]="#7848a0",o["z-index"]=20),"area"===n&&t.hasOwnProperty("building")&&(o.width=.3,o.color="#cca352",o["z-index"]=17),"area"===n&&t.hasOwnProperty("building")&&19<=a&&(o.text=f.default.e_localize(t,"addr:housenumber"),o["text-halo-radius"]=1,o["text-position"]="center",o["font-size"]="8",o["-x-mapnik-min-distance"]="10",o.opacity=.8),"node"===i&&"milestone"===t.highway&&t.hasOwnProperty("pk")&&(o.text=f.default.e_localize(t,"pk"),o["font-size"]="7",o["text-halo-radius"]=5,o["-x-mapnik-min-distance"]="0"),"way"===i&&"line"===n&&void 0===t.highway&&(o.color="#000000",o.width=.5),"way"===i&&"line"===n&&void 0===t.highway&&(o.color="#000000",o.width=1),"way"===i&&"line"===n&&void 0===t.highway&&(o.color="#000000",o.width=1.5),Object.keys(o).length&&(e.default=o),Object.keys(l).length&&(e.centerline=l),Object.keys(r).length&&(e.ticks=r),Object.keys(s).length&&(e.label=s),e}}]),e}();a.default=o},{"./mapcss":9}],11:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,l=(i=e("./mapcss"))&&i.__esModule?i:{default:i};function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this._defaultCanvasStyles={strokeStyle:"rgba(0,0,0,0.5)",fillStyle:"rgba(0,0,0,0.5)",lineWidth:1,lineCap:"round",lineJoin:"round",textAlign:"center",textBaseline:"middle"}}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(u,null,[{key:"populateLayers",value:function(e,t,a){var i,n,o,l,r,s={},f=u.styleFeatures(e,t,a);for(i=0,n=f.length;i<n;i++)s[l=(r=(o=f[i]).style["-x-mapnik-layer"])?"top"===r?1e4:r:o.properties.layer||1e3]=s[l]||[],s[l].push(o);return s}},{key:"getStyle",value:function(e,t,a){var i,n,o=e.type;return"LineString"===o||"MultiLineString"===o?(i="way",n="line"):"Polygon"===o||"MultiPolygon"===o?(i="way",n="area"):"Point"!==o&&"MultiPoint"!==o||(n=i="node"),l.default.shared.restyle(a,e.properties,t,i,n)}},{key:"styleFeatures",value:function(e,t,a){var i,n,o,l,r,s,f,c=[];for(i=0,o=e.length;i<o;i++)for(n in l=e[i],r=u.getStyle(l,t,a)){if("default"===n)s=l;else for(f in s={},l)s[f]=l[f];s.kothicId=i+1,s.style=r[n],s.zIndex=r[n]["z-index"]||0,s.sortKey=s.zIndex,c.push(s)}return c.sort(function(e,t){return e.zIndex<t.zIndex?-1:e.zIndex>t.zIndex?1:0}),c}},{key:"getFontString",value:function(e,t,a){t=t||9;var i=(e=e||"")?e+", ":"";e=e.toLowerCase();var n=[];return"italic"!==a["font-style"]&&"oblique"!==a["font-style"]||n.push(a["font-style"]),"small-caps"===a["font-letiant"]&&n.push(a["font-letiant"]),"bold"===a["font-weight"]&&n.push(a["font-weight"]),n.push(t+"px"),-1!==e.indexOf("serif")&&-1===e.indexOf("sans-serif")?i+="Georgia, serif":i+='"Helvetica Neue", Arial, Helvetica, sans-serif',n.push(i),n.join(" ")}},{key:"setStyles",value:function(e,t){var a;for(a in t)t.hasOwnProperty(a)&&(e[a]=t[a])}},{key:"defaultCanvasStyles",get:function(){return this._defaultCanvasStyles}}]),u}();a.default=o},{"./mapcss":9}],12:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,n=(i=e("./rbush"))&&i.__esModule?i:{default:i};function l(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function o(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.buffer=new n.default,this.height=e,this.width=t}return function(e,t,a){t&&l(e.prototype,t),a&&l(e,a)}(o,[{key:"addPointWH",value:function(e,t,a,i,n){this.buffer.insert(o.getBoxFromPoint(e,t,a,i,n))}},{key:"addPoints",value:function(e){for(var t=[],a=0,i=e.length;a<i;a++)t.push(o.getBoxFromPoint.apply(this,e[a]));this.buffer.load(t)}},{key:"checkBox",value:function(e,t){var a,i,n=this.buffer.search(e);if(e[0]<0||e[1]<0||e[2]>this.width||e[3]>this.height)return!0;for(a=0,i=n.length;a<i;a++)if(t!==n[a][4])return!1;return!1}},{key:"checkPointWH",value:function(e,t,a,i){return this.checkBox(o.getBoxFromPoint(e,t,a,0),i)}}],[{key:"getBoxFromPoint",value:function(e,t,a,i,n){var o=t/2+i,l=a/2+i;return[e[0]-o,e[1]-l,e[0]+o,e[1]+l,n]}}]),o}();a.default=o},{"./rbush":14}],13:[function(e,t,a){"use strict";function n(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=function(){function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}return function(e,t,a){t&&n(e.prototype,t),a&&n(e,a)}(i,null,[{key:"transformPoint",value:function(e,t,a){return[t*e[0],a*e[1]]}},{key:"transformPoints",value:function(e,t,a){var i,n,o=[];for(i=0,n=e.length;i<n;i++)void 0!==e[i]&&o.push(this.transformPoint(e[i],t,a));return o}},{key:"getReprPoint",value:function(e){var t,a;switch(e.type){case"Point":t=e.coordinates;break;case"Polygon":t=e.reprpoint;break;case"LineString":a=i.getPolyLength(e.coordinates),t=[(t=i.getAngleAndCoordsAtLength(e.coordinates,a/2,0))[1],t[2]];break;case"GeometryCollection":return;case"MultiPoint":return void console.log("MultiPoint");case"MultiPolygon":t=e.reprpoint;break;case"MultiLineString":return void console.log("MultiLineString")}return t}},{key:"getPolyLength",value:function(e){var t,a,i,n,o,l=e.length,r=0;for(i=1;i<l;i++)t=e[i],n=(a=e[i-1])[0]-t[0],o=a[1]-t[1],r+=Math.sqrt(n*n+o*o);return r}},{key:"getAngleAndCoordsAtLength",value:function(e,t,a){var i,n,o,l,r,s,f,c,u,h=e.length,d=0,y=0,g=!0,p=!1;for(a=a||0,r=1;r<h;r++){if(p&&(g=!1),s=e[r],f=e[r-1],i=s[0]-f[0],n=s[1]-f[1],y=Math.sqrt(i*i+n*n),!p&&t<=d+y&&(u=t-d,o=f[0]+i*u/y,l=f[1]+n*u/y,p=!0),p&&t+a<=d+y)return u=t+a-d,i=f[0]+i*u/y,n=f[1]+n*u/y,c=Math.atan2(n-l,i-o),g?[c,o,l,y-u]:[c,o,l,0];d+=y}}}]),i}();a.default=i},{}],14:[function(e,t,a){"use strict";function i(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=function(){function a(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),!(this instanceof a))return new a(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}return function(e,t,a){t&&i(e.prototype,t),a&&i(e,a)}(a,[{key:"all",value:function(){return this._all(this.data,[])}},{key:"search",value:function(e){var t=this.data,a=[],i=this.toBBox;if(!this.intersects(e,t.bbox))return a;for(var n,o,l,r,s=[];t;){for(n=0,o=t.children.length;n<o;n++)l=t.children[n],r=t.leaf?i(l):l.bbox,this.intersects(e,r)&&(t.leaf?a.push(l):contains(e,r)?this._all(l,a):s.push(l));t=s.pop()}return a}},{key:"load",value:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,a=e.length;t<a;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this}},{key:"insert",value:function(e){return e&&this._insert(e,this.data.height-1),this}},{key:"clear",value:function(){return this.data={children:[],height:1,bbox:this.empty(),leaf:!0},this}},{key:"remove",value:function(e){if(!e)return this;for(var t,a,i,n,o=this.data,l=this.toBBox(e),r=[],s=[];o||r.length;){if(o||(o=r.pop(),a=r[r.length-1],t=s.pop(),n=!0),o.leaf&&-1!==(i=o.children.indexOf(e)))return o.children.splice(i,1),r.push(o),this._condense(r),this;n||o.leaf||!contains(o.bbox,l)?a?(t++,o=a.children[t],n=!1):o=null:(r.push(o),s.push(t),t=0,o=(a=o).children[0])}return this}},{key:"toBBox",value:function(e){return e}},{key:"compareMinX",value:function(e,t){return e[0]-t[0]}},{key:"compareMinY",value:function(e,t){return e[1]-t[1]}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(e){return this.data=e,this}},{key:"_all",value:function(e,t){for(var a=[];e;)e.leaf?t.push.apply(t,e.children):a.push.apply(a,e.children),e=a.pop();return t}},{key:"_build",value:function(e,t,a,i){var n,o=a-t+1,l=this._maxEntries;if(o<=l)return n={children:e.slice(t,a+1),height:1,bbox:null,leaf:!0},this.calcBBox(n,this.toBBox),n;i||(i=Math.ceil(Math.log(o)/Math.log(l)),l=Math.ceil(o/Math.pow(l,i-1))),n={children:[],height:i,bbox:null};var r,s,f,c,u=Math.ceil(o/l),h=u*Math.ceil(Math.sqrt(l));for(this.multiSelect(e,t,a,h,this.compareMinX),r=t;r<=a;r+=h)for(f=Math.min(r+h-1,a),this.multiSelect(e,r,f,u,this.compareMinY),s=r;s<=f;s+=u)c=Math.min(s+u-1,f),n.children.push(this._build(e,s,c,i-1));return this.calcBBox(n,this.toBBox),n}},{key:"_chooseSubtree",value:function(e,t,a,i){for(var n,o,l,r,s,f,c,u;i.push(t),!t.leaf&&i.length-1!==a;){for(c=u=1/0,n=0,o=t.children.length;n<o;n++)l=t.children[n],s=this.bboxArea(l.bbox),(f=this.enlargedArea(e,l.bbox)-s)<u?(u=f,c=s<c?s:c,r=l):f===u&&s<c&&(c=s,r=l);t=r}return t}},{key:"_insert",value:function(e,t,a){var i=this.toBBox,n=a?e.bbox:i(e),o=[],l=this._chooseSubtree(n,this.data,t,o);for(l.children.push(e),this.extend(l.bbox,n);0<=t&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(n,o,t)}},{key:"_split",value:function(e,t){var a=e[t],i=a.children.length,n=this._minEntries;this._chooseSplitAxis(a,n,i);var o={children:a.children.splice(this._chooseSplitIndex(a,n,i)),height:a.height};a.leaf&&(o.leaf=!0),this.calcBBox(a,this.toBBox),this.calcBBox(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(a,o)}},{key:"_splitRoot",value:function(e,t){this.data={children:[e,t],height:e.height+1},this.calcBBox(this.data,this.toBBox)}},{key:"_chooseSplitIndex",value:function(e,t,a){var i,n,o,l,r,s,f,c;for(s=f=1/0,i=t;i<=a-t;i++)n=this.distBBox(e,0,i,this.toBBox),o=this.distBBox(e,i,a,this.toBBox),l=this.intersectionArea(n,o),r=this.bboxArea(n)+this.bboxArea(o),l<s?(s=l,c=i,f=r<f?r:f):l===s&&r<f&&(f=r,c=i);return c}},{key:"_chooseSplitAxis",value:function(e,t,a){var i=e.leaf?this.compareMinX:this.compareNodeMinX,n=e.leaf?this.compareMinY:this.compareNodeMinY;this._allDistMargin(e,t,a,i)<this._allDistMargin(e,t,a,n)&&e.children.sort(i)}},{key:"_allDistMargin",value:function(e,t,a,i){e.children.sort(i);var n,o,l=this.toBBox,r=this.distBBox(e,0,t,l),s=this.distBBox(e,a-t,a,l),f=this.bboxMargin(r)+this.bboxMargin(s);for(n=t;n<a-t;n++)o=e.children[n],this.extend(r,e.leaf?l(o):o.bbox),f+=this.bboxMargin(r);for(n=a-t-1;t<=n;n--)o=e.children[n],this.extend(s,e.leaf?l(o):o.bbox),f+=this.bboxMargin(s);return f}},{key:"_adjustParentBBoxes",value:function(e,t,a){for(var i=a;0<=i;i--)this.extend(t[i].bbox,e)}},{key:"_condense",value:function(e){for(var t,a=e.length-1;0<=a;a--)0===e[a].children.length?0<a?(t=e[a-1].children).splice(t.indexOf(e[a]),1):this.clear():this.calcBBox(e[a],this.toBBox)}},{key:"_initFormat",value:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return [a"+e.join(", a")+"];")}},{key:"calcBBox",value:function(e,t){e.bbox=this.distBBox(e,0,e.children.length,t)}},{key:"distBBox",value:function(e,t,a,i){for(var n,o=this.empty(),l=t;l<a;l++)n=e.children[l],this.extend(o,e.leaf?i(n):n.bbox);return o}},{key:"empty",value:function(){return[1/0,1/0,-1/0,-1/0]}},{key:"extend",value:function(e,t){return e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e}},{key:"compareNodeMinX",value:function(e,t){return e.bbox[0]-t.bbox[0]}},{key:"compareNodeMinY",value:function(e,t){return e.bbox[1]-t.bbox[1]}},{key:"bboxArea",value:function(e){return(e[2]-e[0])*(e[3]-e[1])}},{key:"bboxMargin",value:function(e){return e[2]-e[0]+(e[3]-e[1])}},{key:"enlargedArea",value:function(e,t){return(Math.max(t[2],e[2])-Math.min(t[0],e[0]))*(Math.max(t[3],e[3])-Math.min(t[1],e[1]))}},{key:"intersectionArea",value:function(e,t){var a=Math.max(e[0],t[0]),i=Math.max(e[1],t[1]),n=Math.min(e[2],t[2]),o=Math.min(e[3],t[3]);return Math.max(0,n-a)*Math.max(0,o-i)}},{key:"contains",value:function(e,t){return e[0]<=t[0]&&e[1]<=t[1]&&t[2]<=e[2]&&t[3]<=e[3]}},{key:"intersects",value:function(e,t){return t[0]<=e[2]&&t[1]<=e[3]&&t[2]>=e[0]&&t[3]>=e[1]}},{key:"multiSelect",value:function(e,t,a,i,n){for(var o,l=[t,a];l.length;)(a=l.pop())-(t=l.pop())<=i||(o=t+Math.ceil((a-t)/i/2)*i,this.select(e,t,a,o,n),l.push(t,o,o,a))}},{key:"select",value:function(e,t,a,i,n){for(var o,l,r,s,f,c,u,h,d;t<a;){for(600<a-t&&(o=a-t+1,l=i-t+1,r=Math.log(o),s=.5*Math.exp(2*r/3),f=.5*Math.sqrt(r*s*(o-s)/o)*(l-o/2<0?-1:1),c=Math.max(t,Math.floor(i-l*s/o+f)),u=Math.min(a,Math.floor(i+(o-l)*s/o+f)),this.select(e,c,u,i,n)),h=e[i],l=t,d=a,this.swap(e,t,i),0<n(e[a],h)&&this.swap(e,t,a);l<d;){for(this.swap(e,l,d),l++,d--;n(e[l],h)<0;)l++;for(;0<n(e[d],h);)d--}0===n(e[t],h)?this.swap(e,t,d):(d++,this.swap(e,d,a)),d<=i&&(t=d+1),i<=d&&(a=d-1)}}},{key:"swap",value:function(e,t,a){var i=e[t];e[t]=e[a],e[a]=i}}]),a}();a.default=n},{}]},{},[1]);